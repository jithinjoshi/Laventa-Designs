<%- include('../partials/admin.ejs') %>


    <%- include('../partials/admin-dashboard.ejs') %>


        <main id="main" class="main">
            <div class="d-flex m-4">
                <button class="btn btn-primary ms-3" onclick="yearlyReportPDF()">Yearly Report</button>
                <button class="btn btn-primary ms-3" onclick="monthlyReportPDF()">Monthly Report</button>
                <button class="btn btn-primary ms-3" onclick="weeklyReportPDF()">Daily Report</button>
            </div>

            <div class="pagetitle" style="display: flex;">
                <h1>Yearly Report</h1>

            </div><!-- End Page Title -->

            <section class="section dashboard">
                <div class="row">

                    <!-- Left side columns -->
                    <div class="col-lg-12">
                        <div class="row">


                            <!-- Top Selling -->
                            <div class="col-12">
                                <div class="card top-selling">

                                    <div class="card-body pb-0">


                                        <table class="table table-nowrap ms-5" id="yearly-table"
                                            style="margin-top: 6%; overflow-x: hidden;">
                                            <thead class="thead-light">
                                                <tr>
                                                    <th scope="col">NO.</th>
                                                    <th scope="col">Year</th>
                                                    <th scope="col">Orders</th>
                                                    <th scope="col">Total</th>
                                                </tr>
                                            </thead>
                                            <tbody>
                                                <% yearlyReport.forEach((year,index)=> { %>
                                                    <tr>
                                                        <td>
                                                            <%= index+1 %>
                                                        </td>
                                                        <td>
                                                            <p class="text-heading font-semibold">
                                                                <%= year._id %>
                                                            </p>
                                                        </td>
                                                        <td>
                                                            <p class="text-heading font-semibold">
                                                                <%= year.count %>

                                                            </p>
                                                        </td>

                                                        <td>
                                                            <p class="text-heading font-semibold">
                                                                <%= year.total %>
                                                            </p>

                                                        </td>
                                                    </tr>
                                                    <% }) %>
                                            </tbody>
                                        </table>

                                    </div>

                                </div>
                            </div><!-- End Top Selling -->

                        </div>
                    </div><!-- End Left side columns -->


                </div>
            </section>

            <div class="pagetitle" style="display: flex;">
                <h1>Monthly Report</h1>

            </div><!-- End Page Title -->

            <section class="section dashboard">
                <div class="row">

                    <!-- Left side columns -->
                    <div class="col-lg-12">
                        <div class="row">


                            <!-- Top Selling -->
                            <div class="col-12">
                                <div class="card top-selling">

                                    <div class="card-body pb-0">


                                        <table class="table table-nowrap ms-5" id="monthly-table"
                                            style="margin-top: 6%; overflow-x: hidden;">
                                            <thead class="thead-light">
                                                <tr>
                                                    <th scope="col">NO.</th>
                                                    <th scope="col">Month</th>
                                                    <th scope="col">Orders</th>
                                                    <th scope="col">Total</th>
                                                </tr>
                                            </thead>
                                            <tbody>
                                                <% monthlyReport.forEach((month,index)=> { %>
                                                    <tr>
                                                        <td>
                                                            <%= index+1 %>
                                                        </td>
                                                        <td>
                                                            <p class="text-heading font-semibold">
                                                                <%= month._id %>
                                                            </p>
                                                        </td>
                                                        <td>
                                                            <p class="text-heading font-semibold">
                                                                <%= month.count %>

                                                            </p>
                                                        </td>

                                                        <td>
                                                            <p class="text-heading font-semibold">
                                                                <%= month.total %>
                                                            </p>

                                                        </td>
                                                    </tr>
                                                    <% }) %>
                                            </tbody>
                                        </table>

                                    </div>

                                </div>
                            </div><!-- End Top Selling -->

                        </div>
                    </div><!-- End Left side columns -->


                </div>
            </section>

            <div class="pagetitle" style="display: flex;">
                <h1>Daily Report</h1>

            </div><!-- End Page Title -->

            <section class="section dashboard">
                <div class="row">

                    <!-- Left side columns -->
                    <div class="col-lg-12">
                        <div class="row">


                            <!-- Top Selling -->
                            <div class="col-12">
                                <div class="card top-selling">

                                    <div class="card-body pb-0">


                                        <table class="table table-nowrap ms-5" id="weekly-table"
                                            style="margin-top: 6%; overflow-x: hidden;">
                                            <thead class="thead-light">
                                                <tr>
                                                    <th scope="col">NO.</th>
                                                    <th scope="col">Day</th>
                                                    <th scope="col">Orders</th>
                                                    <th scope="col">Total</th>
                                                </tr>
                                            </thead>
                                            <tbody>
                                                <% dailyReport.forEach((day,index)=> { %>
                                                    <tr>
                                                        <td>
                                                            <%= index+1 %>
                                                        </td>
                                                        <td>
                                                            <p class="text-heading font-semibold">
                                                                <%= day._id %>
                                                            </p>
                                                        </td>
                                                        <td>
                                                            <p class="text-heading font-semibold">
                                                                <%= day.count %>

                                                            </p>
                                                        </td>

                                                        <td>
                                                            <p class="text-heading font-semibold">
                                                                <%= day.total %>
                                                            </p>

                                                        </td>
                                                    </tr>
                                                    <% }) %>
                                            </tbody>
                                        </table>

                                    </div>

                                </div>
                            </div><!-- End Top Selling -->

                        </div>
                    </div><!-- End Left side columns -->


                </div>
            </section>

        </main><!-- End #main -->
        <a href="#" class="back-to-top d-flex align-items-center justify-content-center"><i
                class="bi bi-arrow-up-short"></i></a>

        <!-- Vendor JS Files -->
        <script src="/assets/vendor/apexcharts/apexcharts.min.js"></script>
        <script src="/assets/vendor/bootstrap/js/bootstrap.bundle.min.js"></script>
        <script src="/assets/vendor/chart.js/chart.min.js"></script>
        <script src="/assets/vendor/echarts/echarts.min.js"></script>
        <script src="/assets/vendor/quill/quill.min.js"></script>
        <script src="/assets/vendor/simple-datatables/simple-datatables.js"></script>
        <script src="/assets/vendor/tinymce/tinymce.min.js"></script>
        <script src="/assets/vendor/php-email-form/validate.js"></script>

        <!-- Template Main JS File -->
        <script src="/assets/js/main.js"></script>

        <script>
            function weeklyReportPDF() {
                var doc = new jsPDF('p', 'pt', 'letter');
                var htmlstring = '';
                var tempVarToCheckPageHeight = 0;
                var pageHeight = 0;
                pageHeight = doc.internal.pageSize.height;
                specialElementHandlers = {
                    // element with id of "bypass" - jQuery style selector  
                    '#bypassme': function (element, renderer) {
                        // true = "handled elsewhere, bypass text extraction"  
                        return true
                    }
                };
                margins = {
                    top: 150,
                    bottom: 60,
                    left: 40,
                    right: 40,
                    width: 600
                };
                var y = 20;
                doc.setLineWidth(2);
                doc.text(200, y = y + 30, "Weekly Sales Report");
                doc.autoTable({
                    html: '#weekly-table',
                    startY: 70,
                    theme: 'grid',
                    columnStyles: {
                        0: {
                            cellWidth: 180,
                        },
                        1: {
                            cellWidth: 80,
                        },
                        2: {
                            cellWidth: 80,
                        },

                    },
                    styles: {
                        minCellHeight: 40
                    }
                })
                doc.save('sales-weekly-report.pdf');
            }


            function monthlyReportPDF() {
                var doc = new jsPDF('p', 'pt', 'letter');
                var htmlstring = '';
                var tempVarToCheckPageHeight = 0;
                var pageHeight = 0;
                pageHeight = doc.internal.pageSize.height;
                specialElementHandlers = {
                    // element with id of "bypass" - jQuery style selector  
                    '#bypassme': function (element, renderer) {
                        // true = "handled elsewhere, bypass text extraction"  
                        return true
                    }
                };
                margins = {
                    top: 150,
                    bottom: 60,
                    left: 40,
                    right: 40,
                    width: 600
                };
                var y = 20;
                doc.setLineWidth(2);
                doc.text(200, y = y + 30, "Monthly Sales Report");
                doc.autoTable({
                    html: '#monthly-table',
                    startY: 70,
                    theme: 'grid',
                    columnStyles: {
                        0: {
                            cellWidth: 180,
                        },
                        1: {
                            cellWidth: 80,
                        },
                        2: {
                            cellWidth: 80,
                        },
                    },
                    styles: {
                        minCellHeight: 40
                    }
                })
                doc.save('sales-monthly-report.pdf');
            }


            function yearlyReportPDF() {
                var doc = new jsPDF('p', 'pt', 'letter');
                var htmlstring = '';
                var tempVarToCheckPageHeight = 0;
                var pageHeight = 0;
                pageHeight = doc.internal.pageSize.height;
                specialElementHandlers = {
                    // element with id of "bypass" - jQuery style selector  
                    '#bypassme': function (element, renderer) {
                        // true = "handled elsewhere, bypass text extraction"  
                        return true
                    }
                };
                margins = {
                    top: 150,
                    bottom: 60,
                    left: 40,
                    right: 40,
                    width: 600
                };
                var y = 20;
                doc.setLineWidth(2);
                doc.text(200, y = y + 30, "Yearly Sales Report");
                doc.autoTable({
                    html: '#yearly-table',
                    startY: 70,
                    theme: 'grid',
                    columnStyles: {
                        0: {
                            cellWidth: 180,
                        },
                        1: {
                            cellWidth: 80,
                        },
                        2: {
                            cellWidth: 80,
                        },
                    },
                    styles: {
                        minCellHeight: 40
                    }
                })
                doc.save('sales-yearly-report.pdf');
            }
        </script>


        <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/1.5.3/jspdf.min.js"></script>
        <script
            src="https://cdnjs.cloudflare.com/ajax/libs/jspdf-autotable/3.5.6/jspdf.plugin.autotable.min.js"></script>

        <%- include('../partials/footer.ejs') %>